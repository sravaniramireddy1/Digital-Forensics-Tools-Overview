
# **Ex.No.10 â€” Use Ghidra to Disassemble and Analyze Malware Code**

**ğŸ“š Course / Lab:** Digital Forensics Lab

**ğŸ§¾ Experiment No:** 10

**ğŸ“ Title:** Use Ghidra to Disassemble and Analyze Malware Code

**ğŸ“… Date:** : 27-10-2025

**ğŸ†” Reg No:** 99230040849

---

## ğŸ“˜ **Description**

**Ghidra** is an open-source reverse engineering framework developed by the **U.S. National Security Agency (NSA)**.
It is widely used for **disassembling, decompiling, and analyzing executable files** to understand their internal operations and detect possible malicious behavior.
This experiment demonstrates how Ghidra can be used to analyze **malware or suspicious binaries** in a safe and controlled environment.

---

## ğŸ¯ **Objectives**

* ğŸ” Understand how to disassemble and analyze binary executables using Ghidra.
* ğŸ§  Identify **malware behaviors** such as persistence, obfuscation, or network communication.
* âš™ï¸ Learn to interpret **assembly and decompiled code** to understand program functionality.
* ğŸ§© Explore how to automate analysis using **Python or Java scripting** in Ghidra.

---

## âš™ï¸ **Requirements**

* ğŸ–¥ï¸ System with Windows/Linux/macOS
* â˜• **Java Runtime Environment (JRE)** installed
* ğŸ§° **Ghidra** (latest version) downloaded from [https://ghidra-sre.org](https://ghidra-sre.org)
* ğŸ”’ **Virtual Machine (VM)** setup for safe malware testing
* ğŸ§± **Sample binary file** (benign or dummy malware sample)

---

## ğŸªœ **Step-by-Step Process**

### ğŸ”¹ Step 1: Environment Setup

**ğŸ¯ Purpose:** Prepare a secure and isolated setup for reverse engineering.

**ğŸ“‹ Instructions:**

1. Install **Ghidra** on the host system.
2. Create a **Virtual Machine** using tools like **VirtualBox** or **VMware**.
3. Disable network connectivity inside the VM for safety.
4. Place the sample binary file inside the VM for analysis.

---

### ğŸ”¹ Step 2: Launch Ghidra and Create a New Project

1. Open **Ghidra** and select **File â†’ New Project**.
2. Choose **Non-Shared Project**, name it (e.g., `Malware_Analysis`).
3. Import the binary file using **File â†’ Import File**.
4. Ghidra will automatically detect the file type (EXE, ELF, etc.) and format it for analysis.

<details>
<summary>ğŸ“¸ View Project Setup Example</summary>
<br>
<p align="center">
  <img width="700" alt="Ghidra project setup" src="https://github.com/baddiputi/Digital-Forensic-Lab-Exercises/blob/main/images/10.1.png" />
</p>
</details>

---

### ğŸ”¹ Step 3: Perform Auto Analysis

**ğŸ¯ Purpose:** Allow Ghidra to automatically detect functions and code patterns.

1. Right-click the imported binary â†’ **Analyze**.
2. In the dialog box, check **Auto Analysis** and press **Yes**.
3. Ghidra disassembles and decompiles the binary, showing assembly and high-level code side by side.

---

### ğŸ”¹ Step 4: Examine Functions and Code Flow

1. Open the **Listing Window** to view assembly instructions.
2. Use the **Decompiler Window** to see C-like pseudocode.
3. Navigate to `main()` or entry point using **Symbol Tree**.
4. Observe:

   * Function calls and variable names
   * Conditional branches and loops
   * Suspicious patterns like file access or network calls

<details>
<summary>ğŸ§© View Decompiled Code Example</summary>
<br>
<p align="center">
  <img width="700" alt="Decompiler view example" src="https://github.com/baddiputi/Digital-Forensic-Lab-Exercises/blob/main/images/10.2.png" />
</p>
</details>

---

### ğŸ”¹ Step 5: Analyze Strings and Imports

1. Open **Window â†’ Defined Strings** to view readable text inside the binary.
2. Look for keywords like `"http"`, `"socket"`, `"cmd"`, `"password"`, or `"registry"`.
3. Open **Imports Window** to see which system libraries are used.
4. Check for suspicious imports such as:

   * `CreateProcessA`, `ShellExecuteA` â†’ Execution
   * `InternetOpenUrlA`, `WSAStartup` â†’ Network
   * `RegSetValueA` â†’ Persistence

---

### ğŸ”¹ Step 6: Identify Suspicious Behavior

* ğŸ§¬ Check **control flow graphs** to trace code execution.
* ğŸ” Identify **loops or functions** used repeatedly (may indicate encryption or packing).
* ğŸ§± Observe anti-analysis tricks like dynamic loading or obfuscation.
* ğŸ’» Use **Comments** feature in Ghidra to annotate findings.

<details>
<summary>ğŸ” View Control Flow Graph</summary>
<br>
<p align="center">
  <img width="700" alt="Control flow graph" src="https://github.com/baddiputi/Digital-Forensic-Lab-Exercises/blob/main/images/10.3.png" />
</p>
</details>

---

### ğŸ”¹ Step 7: Automate Analysis with Scripts

**ğŸ“œ Example Python Script â€” Extract All Strings**

```python
from ghidra.program.model.symbol import SymbolType

for s in currentProgram.getSymbolTable().getAllSymbols(True):
    if s.getSymbolType() == SymbolType.LABEL:
        print(s.getName())
```

**ğŸ¯ Purpose:** Automates repetitive analysis tasks and saves time.
Scripts can also:

* Detect function names related to networking
* Tag known malware functions
* Export data for reporting

---

### ğŸ”¹ Step 8: Document Findings

Prepare a structured report containing:

* ğŸ§© **Overview:** Type of file and analysis summary
* ğŸ” **Function Analysis:** Key functions and their behavior
* ğŸŒ **Network Indicators:** URLs, IPs, or domains found
* ğŸ”’ **Persistence Techniques:** Registry edits or autorun entries
* ğŸ§  **Conclusion:** Summary of malware functionality and threat level

---

## âœ… **Result**

The malware code was successfully analyzed using **Ghidra**.
The experiment demonstrated how to disassemble a binary, interpret assembly code, view decompiled functions, and identify potential malicious behaviors.
Ghidra proved to be a powerful static analysis tool for understanding malware operations in a secure environment.

ğŸ¯ **Key Outcomes:**

* âœ… Setup of a safe and isolated analysis environment
* âœ… Successful import and disassembly of the binary file
* âœ… Identified important functions, imports, and strings
* âœ… Documented malware behaviors like persistence and communication
* âœ… Used Python automation for deeper analysis

---

## ğŸ“ **Notes**

âš ï¸ **Safety Precaution:** Always analyze unknown binaries in an isolated virtual machine with no internet access. 

ğŸ”’ **Legal Compliance:** Reverse engineering should only be performed on authorized or educational samples.

ğŸ§  **Documentation:** Maintain a detailed record of analysis steps and findings.

ğŸ’¡ **Tip:** Use Ghidraâ€™s â€œBookmarksâ€ and â€œCommentsâ€ to track important sections of code.

ğŸ“˜ **Further Study:** Learn advanced Ghidra scripting and P-Code emulation for runtime analysis.

---

## ğŸ’¡ **Future Enhancements**

* âš™ï¸ Add more automation scripts for bulk analysis.
* ğŸ§© Include examples of obfuscated binaries.
* ğŸŒ Build a collaborative repository for Ghidra script sharing.
* ğŸ”¬ Explore dynamic malware analysis with Ghidraâ€™s **P-Code emulator**.

